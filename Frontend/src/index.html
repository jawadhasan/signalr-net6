<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <base href="/">
  <title>In Memory SignalR Chat</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

  <!-- Style Sheets -->
  <link rel="stylesheet" href="site.css">
</head>

<body class="container-fluid">

  <nav class="navbar navbar-expand-lg navbar-light bg-light border">
    <a class="navbar-brand" href="/">In Memory SignalR Chat</a>
  </nav>

  <div id="indexPage">

    <div class="alert alert-primary" role="alert" data-bind="text:pageAlert">
    </div>

    <div class="row">

      <!-- Chat Area -->
      <div id="chatArea" class="col col-md-6  bg-light">

        <!-- Welcome -->
        <div class="bg-dark">
          <span data-bind="text: title" class="text-white"></span>&nbsp;
          <span class="fa fa-signal text-success" data-bind="visible:signalRConnected"></span>
          <h4 data-bind="text:`Welcome ` + `${nick()}`, visible:isJoined" class="text-white"></h4>         
        </div>

        <!-- NickName & Join -->
        <div class="form-inline">
          <input required class="form-control" id="inputText" type="input"
            data-bind="value:nick, valueUpdate: 'afterkeydown', visible: !isJoined()" placeholder="Enter Nick Name" />

          <button class="btn btn-primary"
            data-bind="visible: !isJoined(), enable: nick().length > 0, click: join">Join</button>
        </div>
        
        <!-- Chat Messages block -->
        <div id="messages" data-bind="foreach: chatMessages">
          <div>
            <span class="fa fa-clock"></span>
            <span class="date" data-bind="text: displayDate"></span>

            <span class="message" data-bind="if: eventType == 2">
              <span class="user" data-bind="text: user, css: { you: user == `${$parent.nick()}` }"></span>&gt;

              <span class="text" data-bind="text: text"></span>
            </span>

            <span class="join" data-bind="if: eventType == 0">
              <span class="user" data-bind="text: user"></span> joins the room.
            </span>

            <span class="leave" data-bind="if: eventType == 1">
              <!-- or eventType == 'LEAVE' -->
              <span class="user" data-bind="text: user"></span> leaves the room.
            </span>

          </div>
        </div>

        <!-- Send Message -->
        <form class="form-inline" id="inputForm" data-bind="submit: say, visible:isJoined">
          <input class="form-control" id="inputText" type="input" data-bind="enable: isJoined, value: messageText"
            placeholder="Type your message here" />
          <input class="btn btn-primary" type="submit" value="Send" data-bind="enable: isJoined" />
          <button class="btn btn-warning" data-bind="click: clearChat">Clear</button>
          <button class="btn btn-info" data-bind="visible: isJoined(), click: getChatHistory">Chat-History</button>
        </form>    

      </div><!-- End Chat Area -->

      <!--online users  -->
      <div id="onlineArea" class="col col-md-4">
        <h4 class="bg-dark text-white">Online users:  <span data-bind="text: onlineUsers().length"></span></h4>
        <div id="onlineusers" data-bind="foreach: onlineUsers">
          <div>
            <span class="fa fa-user"></span> &nbsp; <span data-bind="text: $data"></span>
          </div>
        </div>      
      </div>

    </div> <!-- end row -->


  </div><!-- end indexPage -->

  <!-- App Code -->
  <script src="./index.js"></script>
</body>

</html>